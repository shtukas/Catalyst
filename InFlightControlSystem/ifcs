#!/Users/pascal/.rvm/rubies/ruby-2.5.1/bin/ruby

# encoding: UTF-8

require_relative "InFlightControlSystem.rb"

loop {
    system('clear')
    puts getReportText()
    puts ""
    puts (getReportLine() || "No line report at this moment")
    puts ""
    options = [
        "items dive",
        "apply recommended"
    ]
    option = LucilleCore::selectEntityFromListOfEntitiesOrNull("ifcs", options)
    break if option.nil?
    if option == "items dive" then
        item = selectItemOrNull()
        next if item.nil?
        loop {
            puts "Focus: #{item["description"]}"
            puts JSON.pretty_generate(item)
            puts JSON.pretty_generate(getItemCompanion(item["uuid"]))
            oxs = ["start", "stop"]
            ox = LucilleCore::selectEntityFromListOfEntitiesOrNull("ifcs", oxs)
            break if ox.nil?
            if ox == "start" then
                startItem(item["uuid"])
            end
            if ox == "stop" then
                stopItem(item["uuid"])
            end
        }
    end
    if option == "apply recommended" then
        nextaction = getNextAction()
        nextaction[1].call()
    end
}




